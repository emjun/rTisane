# Statistical analysis
Relying on your conceptual model alone, use rTisane to implement a statistical model that assesses the influence of variables you believe to be important (in the context of additional potentially influential factors) on income.

1. Copy and paste your variables and conceptual model from before. 
```{r}
library(rTisane)
# devtools::load_all()
source("~/Git/rTisane/conceptualDisambiguation/app.R")

# Add here
person <- Unit(name = "person")
# Age: Continuous measure
age <- continuous(unit = person, "Age")
# Race: There are 5 categories: White, Black/African American, American Indian or Alaska Native, Asian or Pacific Islander, Mixed Race
race <- categories(unit = person, "Race", cardinality = 9)
# Highest Education Completed: 5 categories: Grade 12, 1 year of college, 2 years of college, 4 years of college, 5+ years of colleges
edu <- categories(unit = person, "Education", order=list("Grade 12", "1 year of college", "2 years of college", "4 years of college", "5+ years of college"))
# Current Employment Status: 3 categories: N/A, Works for wage, Self-employed
employ <- categories(unit=person, "Employment", cardinality=2)
# Sex: 2 categories: Male, Female
sex <- categories(unit = person, "Sex",cardinality = 2)
# Income: Continuous measure
income <- continuous(unit = person, "Income")

cm <- ConceptualModel()

# Add conceptual relationships here
cm <- assume(cm, causes(employ, income))
cm <- assume(cm, relates(age, income))
cm <- assume(cm, relates(edu, income))
cm <- assume(cm, relates(race, income))
cm <- hypothesize(cm, relates(sex, income, when = equals(sex, 'Female'), decreases(income)))
```

2. Fill in the query with your variable names. Run the above code snippet before running this one below.
```{r}
# Copy and paste above 
# Replace <iv> with an independent variable of interest
# Replace <dv> with the dependent variable of interest. In this case, the variable for income. 
script <- query(conceptualModel=cm, iv=sex, income)
```

3. Copy and paste your statistical modeling script below:  
> Note: You may need to update the path to "/Users/cse-loaner/Git/rTisane/Participants/income_final.csv"
```{r}
# Add statistical model here
#install.packages('tidyverse')
#install.packages('lme4')

library(tidyverse)
library(lme4)
# Replace 'PATH' with a path to your data
data <- read.csv("/Users/cse-loaner/Git/rTisane/Participants/income_final.csv")
lm <- glm(formula=Income ~ Employment+Race+Sex+Education+Age, family=gaussian(link='log'), data=data)
```

4. Run the above snippet (you may want to call "summary" to summarize the output)!

5. Summarize the results of your analysis below: 
